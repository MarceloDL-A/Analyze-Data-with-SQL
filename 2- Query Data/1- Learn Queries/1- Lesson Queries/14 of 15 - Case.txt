Learn Queries

Avatar
Queries: CaseNarrative and Instructions
Learn
QUERIES
Case
A CASE statement allows us to create different outputs (usually in the SELECT statement). It is SQL’s way of handling if-then logic.

Suppose we want to condense the ratings in movies to three levels:

If the rating is above 8, then it is Fantastic.
If the rating is above 6, then it is Poorly Received.
Else, Avoid at All Costs.
SELECT name,
 CASE
  WHEN imdb_rating > 8 THEN 'Fantastic'
  WHEN imdb_rating > 6 THEN 'Poorly Received'
  ELSE 'Avoid at All Costs'
 END
FROM movies;
Each WHEN tests a condition and the following THEN gives us the string if the condition is true.
The ELSE gives us the string if all the above conditions are false.
The CASE statement must end with END.
In the result, you have to scroll right because the column name is very long. To shorten it, we can rename the column to ‘Review’ using AS:

SELECT name,
 CASE
  WHEN imdb_rating > 8 THEN 'Fantastic'
  WHEN imdb_rating > 6 THEN 'Poorly Received'
  ELSE 'Avoid at All Costs'
 END AS 'Review'
FROM movies;
Instructions
1.
Let’s try one on your own.

Select the name column and use a CASE statement to create the second column that is:

‘Chill’ if genre = 'romance'
‘Chill’ if genre = 'comedy'
‘Intense’ in all other cases
Optional: Rename the whole CASE statement to ‘Mood’ using AS.

Give it your best shot! Check hint for the answer.

Checkpoint 2 Passed

Hint
This is the final boss!

Your query should look like:

SELECT name,
 CASE
  WHEN genre = 'romance' THEN 'Chill'
  WHEN genre = 'comedy'  THEN 'Chill'
  ELSE 'Intense'
 END AS 'Mood'
FROM movies;
If the genre is romance, then it is Chill.
If the genre is comedy, then it is Chill.
Else, it is Intense.
Don’t forget the comma after name.

Here is another query that will give us the same result:

SELECT name,
 CASE
  WHEN genre = 'romance' OR genre = 'comedy' 
   THEN 'Chill'
  ELSE 'Intense'
 END AS 'Mood'
FROM movies;
If the genre is romance or comedy, then it is Chill.
Else, it is Intense.
Concept Review
Want to quickly review some of the concepts you’ve been learning? Take a look at this material's cheatsheet!
Community Forums
Here are some helpful links to the top questions asked by coders about this exercise:

For a CASE statement, do all values provided by THEN have to match a single data type?
Still have questions? View this exercise's thread in the Codecademy Forums.
Code Editor
1234
SELECT *
FROM movies
WHERE genre = 'romance'
OR genre = 'comedy';
SQLPreview
Query Results
Run a query to see results.

14. Case
14/15
